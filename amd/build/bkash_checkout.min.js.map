{"version":3,"sources":["../src/bkash_checkout.js"],"names":["define","$","Ajax","mdlcfg","setup","bkash_information","paymentID","username","config","password","app_key","appkey","app_secret","appsecretkey","amount","currency","courseid","userid","instanceid","item_name","document","ready","ajax","url","wwwroot","type","contentType","success","data","console","log","JSON","stringify","token","error","paymentConfig","createCheckoutURL","executeCheckoutURL","paymentRequest","intent","bKash","init","paymentMode","createRequest","request","obj","parse","create","onSuccess","onError","executeRequestOnAuthorization","alert","execute"],"mappings":"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","sourcesContent":["define(['jquery', 'core/ajax', 'core/config'], function ($, Ajax, mdlcfg) {\n\n    return {\n        setup: function (bkash_information) {\n\n\n            var paymentID;\n\n            var username = bkash_information.config.username;\n\n            var password = bkash_information.config.password;\n\n            var app_key = bkash_information.config.appkey;\n\n\n            var app_secret = bkash_information.config.appsecretkey;\n\n            var amount = bkash_information.amount;\n            var currency = bkash_information.currency;\n            var courseid = bkash_information.courseid;\n            var userid = bkash_information.userid;\n            var instanceid = bkash_information.instanceid;\n            var item_name = bkash_information.item_name;\n\n            var accessToken = '';\n            $(document).ready(function () {\n\n                $.ajax({\n                    url: mdlcfg.wwwroot + \"/enrol/bkash/token.php\",\n                    type: 'POST',\n                    contentType: 'application/json',\n                    success: function (data) {\n                        console.log(data);\n                        console.log('got data from token  ..');\n                        console.log(JSON.stringify(data));\n                        accessToken = JSON.stringify(data);\n                        token = data;\n                    },\n                    error: function () {\n                        console.log('error');\n\n                    }\n                });\n\n                var paymentConfig = {\n                    createCheckoutURL: mdlcfg.wwwroot + \"/enrol/bkash/createpayment.php\",\n                    executeCheckoutURL: mdlcfg.wwwroot + \"/enrol/bkash/executepayment.php\",\n                };\n\n\n                var paymentRequest;\n                paymentRequest = { amount: '105', intent: 'sale' };\n                console.log(JSON.stringify(paymentRequest));\n\n                bKash.init({\n                    paymentMode: 'checkout',\n                    paymentRequest: paymentRequest,\n                    createRequest: function (request) {\n                        console.log('=> createRequest (request) :: ');\n                        console.log(request);\n\n                        $.ajax({\n                            url: paymentConfig.createCheckoutURL + \"?amount=\" + paymentRequest.amount,\n                            type: 'GET',\n                            contentType: 'application/json',\n                            success: function (data) {\n                                console.log(data);\n                                console.log('got data from create  ..');\n                                console.log('data ::=>');\n                                console.log(data);\n\n                                var obj = JSON.parse(data);\n                                console.log(obj);\n\n                                if (data && obj.paymentID != null) {\n                                    paymentID = obj.paymentID;\n                                    bKash.create().onSuccess(obj);\n                                }\n                                else {\n                                    console.log('error');\n                                    bKash.create().onError();\n                                }\n                            },\n                            error: function () {\n                                console.log('error');\n                                bKash.create().onError();\n                            }\n                        });\n                    },\n\n                    executeRequestOnAuthorization: function () {\n                        console.log('=> executeRequestOnAuthorization');\n                        $.ajax({\n                            url: paymentConfig.executeCheckoutURL + \"?paymentID=\" + paymentID,\n                            type: 'GET',\n                            contentType: 'application/json',\n                            success: function (data) {\n                                console.log(data);\n                                console.log(data.paymentID);\n                                if (data && data.paymentID != null) {\n                                    alert(data.paymentID);\n\n                                    // window.location.href = mdlcfg.wwwroot + \"/enrol/bkash/process.php?\" + \"paymentID=\" + data.paymentID + \"&amount=\" + amount + \"&currency=\" + currency + \"&courseid=\" + courseid + \"&userid=\" + userid + \"&instanceid=\" + instanceid + \"&item_name=\" + item_name;\n\n                                    // alert('[SUCCESS] data : ' + JSON.stringify(data));\n                                    // window.location.href = \"success.html\";\n                                }\n                                else {\n                                    bKash.execute().onError();\n                                }\n                            },\n                            error: function () {\n                                bKash.execute().onError();\n                            }\n                        });\n                    }\n                });\n\n                console.log(\"Right after init \");\n\n\n            });\n\n            function callReconfigure(val) {\n                bKash.reconfigure(val);\n            }\n\n            function clickPayButton() {\n                $(\"#bKash_button\").trigger('click');\n            }\n        }\n    }\n});\n"],"file":"bkash_checkout.min.js"}